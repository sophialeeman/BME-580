---
title: "Histograms_EDA"
output: html_document
date: "2023-04-02"
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse) # Remember from last homework that dplyr and ggplot2 are included in  tidyverse
library(gridExtra)
library(corrplot)
library(patchwork)
library(factoextra)
library(psych)
library(ggplot2)
set.seed(2023)
```

```{r}

combined_df <- read.csv("C:/Users/tulip/BME580/project/alldata.csv",
         header = TRUE, stringsAsFactors = TRUE)

str(combined_df)

# View the first few rows of the data
head(combined_df,10)

# View the last few rows of the data
tail(combined_df,10)

# Summary statistics of the data
summary(combined_df)

# Check for missing values
sum(is.na(combined_df))

# Remove rows with missing values
combined_df <- na.omit(combined_df)

# Histogram of variables

total<- ggplot(combined_df, aes(x = Total_Test_Results)) +
  geom_histogram(fill = "lightblue", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Total Confirmed COVID-19 Cases", 
       x = "Total Confirmed COVID-19 Cases", 
       y = "Frequency")

deaths<- ggplot(combined_df, aes(x = Deaths)) +
  geom_histogram(fill = "lightblue", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Deaths by COVID-19 Cases", 
       x = "Total Confirmed Deaths", 
       y = "Frequency")

incident<- ggplot(combined_df, aes(x = Incident_Rate)) +
  geom_histogram(fill = "lightblue", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Incident Rate", 
       x = "Incident Rate", 
       y = "Frequency")

ratio<- ggplot(combined_df, aes(x = Case_Fatality_Ratio)) +
  geom_histogram(fill = "lightblue", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Case Fatality Ratio", 
       x = "Case Fatality Ratio", 
       y = "Frequency")

pressure<- ggplot(combined_df, aes(x = Atmospheric.Pressure)) +
  geom_histogram(fill = "lightblue", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Atmospheric Pressure", 
       x = "Atmospheric Pressure", 
       y = "Frequency")

humidity<- ggplot(combined_df, aes(x = Humidity)) +
  geom_histogram(fill = "lightblue", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Humidity", 
       x = "Humidity", 
       y = "Frequency")

anxiety_avg <- combined_df %>%
  filter(Indicator == "Symptoms of Anxiety Disorder") %>%
  summarise(Value = Value)

# Plot a histogram of the average values
anxiety<- ggplot(anxiety_avg, aes(x = Value)) +
  geom_histogram(color = "black", fill = "white") +
  ggtitle("Histogram of Average Values of Value for Indicator = Symptoms of Anxiety Disorder") +
  xlab("Average Value") +
  ylab("Frequency")

depression_avg <- combined_df %>%
  filter(Indicator == "Symptoms of Depressive Disorder") %>%
  summarise(Value = Value)

depress<- ggplot(depression_avg, aes(x = Value)) +
  geom_histogram(fill = "lightgreen", color = "black") +
  scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 5)) +
  labs(title = "Histogram of Percentage of Depression", 
       x = "Percentage of Depression", 
       y = "Frequency")

temp<- ggplot(combined_df, aes(x = Temp)) +
  geom_histogram(fill = "pink", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Avg Temp", 
       x = "Temperature (F)", 
       y = "Frequency")

precip<- ggplot(combined_df, aes(x = Precip)) +
  geom_histogram(fill = "pink", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(title = "Histogram of Precipitation", 
       x = "Precipitation (Inches)", 
       y = "Frequency")

grid.arrange(total, deaths, incident, ratio, pressure, humidity, anxiety, depress, temp, precip)
```